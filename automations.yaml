- id: update_notification
  alias: 'Benachrichtigung:  Update HASS'
  trigger:
  - platform: state
    entity_id: sensor.updater_core
    from: 'off'
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: Update für Home Assitant verfügbar
      notification_id: system_update
      title: Update
    service: script.notify_script
  mode: single
- id: family_not_home
  alias: 'Abwesenheitsmodus: aktivieren (per Push)'
  description: Schaltet alle Lichter und Steckdosen aus und aktiviert den Bewegungssensor
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: TURN_ON_ABSENCE
  - platform: event
    event_type: ios.action_fired
    event_data:
      actionName: absence
  condition: []
  action:
  - data: {}
    service: script.alles_ausschalten
  - data: {}
    service: automation.turn_on
    target:
      entity_id:
      - automation.benachrichtigung_wohnungstur_offen
  - service: input_boolean.turn_on
    data: {}
    target:
      entity_id: input_boolean.abwesenheitsmodus
  mode: single
- id: xiaomi_vacuum_notification_off
  alias: 'Xiaomi Staubsauger: Benachrichtigung fertig'
  trigger:
  - platform: state
    entity_id: vacuum.roborock_vacuum
    to: docked
    from: returning
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'Staubsauger fertig - Dauer: {{ states.sensor.xiaomi_vacuum_v1_last_clean_duration.state
        }} min - gesaugte Fläche: {{ states.sensor.xiaomi_vacuum_last_clean_area.state
        }} qm | Fehler {{ states.counter.xiaomo_errors.state }}'
      notification_id: xiaomi_vacuum_status
      title: StaubRobo
    service: script.notify_script
  mode: single
- id: xiaomi_vacuum_notification_on
  alias: 'Xiaomi Staubsauger: Benachrichtigung gestartet'
  trigger:
  - entity_id: vacuum.roborock_vacuum
    from: docked
    platform: state
    to: cleaning
  action:
  - service: notify.all_ios_devices
    data:
      message: Staubsauger gestartet
      data:
        actions:
        - action: STOP_VACUUM
          title: Staubsauger stoppen
  mode: single
- id: xiaomi_vacuum_notification_blocked
  alias: 'Xiaomi Staubsauger: Benachrichtigung Fehler'
  trigger:
  - entity_id: vacuum.roborock_vacuum
    platform: state
    to: error
  condition:
  - condition: template
    value_template: '{{ states.vacuum.roborock_vacuum.attributes.error != ''Clean
      main brush'' }}'
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'Staubsauger blockiert - Error: {{ states.vacuum.roborock_vacuum.attributes.error
        }} '
      notification_id: xiaomi_vacuum_error
      title: StaubRobo
    service: script.notify_script
  mode: single
- id: '1523001167559'
  alias: 'Xiaomi Staubsauger: Neustart'
  trigger:
  - entity_id: sensor.xiaomi_vacuum_status
    platform: state
    to: Error
  condition:
  - condition: template
    value_template: '{{ states.vacuum.roborock_vacuum.attributes.error == ''Clean
      main brush'' }}'
  action:
  - data:
      entity_id: vacuum.roborock_vacuum
    service: vacuum.start
  - data:
      entity_id: counter.xiaomo_errors
    service: counter.increment
- id: '1532176861984'
  alias: 'Sonos: automatisch starten'
  trigger:
  - entity_id: device_tracker.iphone11pro
    platform: state
    to: home
  condition:
  - condition: and
    conditions:
    - condition: state
      entity_id: person.christina
      state: not_home
  action:
  - service: script.sonos_set_volume_8
  - service: script.sonos_radio_b5_aktuell
  mode: single
- id: '1532273712071'
  alias: 'Entertainment: AVR - Quelle auswählen'
  trigger:
  - entity_id: input_select.avr_source
    platform: state
  condition:
  - condition: template
    value_template: '{{ states.input_select.avr_source.state != "--" }}'
  action:
  - data_template:
      entity_id: media_player.harman_kardon_avr
      source: '{% if states.input_select.avr_source.state == "Telekom" %}STB {% elif
        states.input_select.avr_source.state ==  "AirPlay" %}Audio {% elif states.input_select.avr_source.state
        ==  "TV" %}TV {% elif states.input_select.avr_source.state ==  "Home Network"
        %}Home Network {% elif states.input_select.avr_source.state ==  "vTuner" %}vTuner
        {% elif states.input_select.avr_source.state ==  "Turntable" %}AUX {% endif
        %}'
    service: media_player.select_source
  - data:
      entity_id: input_select.avr_source
      option: --
    service: input_select.select_option
  mode: single
- id: '1533660030341'
  alias: 'Entertainment: AVR - verbinden'
  description: dummy Bedienung um Verbindung sicherzustellen
  trigger:
  - entity_id: device_tracker.avr_151s
    platform: state
    to: home
  condition: []
  action:
  - delay: 00:02:00
  - data:
      entity_id: media_player.harman_kardon_avr
    service: media_player.volume_down
  mode: single
- id: '1533984172028'
  alias: 'Xiaomi Staubsauger: Stoppen '
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: STOP_VACUUM
  - platform: state
    entity_id: person.christina
    to: home
  condition: []
  action:
  - service: vacuum.stop
    data: {}
    target:
      entity_id: vacuum.roborock_vacuum
  mode: single
- id: '1540494970737'
  alias: 'Benachrichtigung: Bewegung erkannt'
  trigger:
  - platform: state
    to: 'on'
    entity_id:
    - binary_sensor.bewegungsmelder
  condition:
  - condition: not
    conditions:
    - condition: state
      entity_id: vacuum.roborock_vacuum
      state: cleaning
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 30
      milliseconds: 0
  - condition: state
    entity_id: group.presence
    state: not_home
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: Bewegung erkannt
      notification_id: alert
      title: Bewegungsmelder
    service: script.notify_script
  initial_state: false
  mode: single
- id: '1540974552306'
  alias: 'Benachrichtigung: Luftfeuchtigkeit'
  trigger:
  - entity_id: sensor.humidity_158d0001b8c96c
    platform: numeric_state
    above: 60
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - entity_id: sensor.humidity_158d0001b8c998
    platform: numeric_state
    above: 60
    for:
      hours: 0
      minutes: 10
      seconds: 0
  - entity_id: sensor.humidity_158d0002239fb5
    platform: numeric_state
    above: 60
    for:
      hours: 0
      minutes: 10
      seconds: 0
  condition: []
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: '{{ trigger.from_state.attributes.friendly_name }} zu hoch: {{ trigger.to_state.state
        }} % '
      notification_id: Luftfeuchtigkeit
      title: Luftfeuchtigkeit
    service: script.notify_script
  mode: single
- id: '1541096569503'
  alias: 'Anwesenheit: Bewegungsmelder - Alarm'
  trigger:
  - entity_id: binary_sensor.tradfri_bewegungsmelder
    platform: state
    to: 'on'
  condition:
  - after: '23:30:00'
    before: 05:00:00
    condition: time
  action:
  - data:
      gw_mac: 7811DCB258D1
      ringtone_id: '0'
      ringtone_vol: 20
    service: xiaomi_aqara.play_ringtone
  - delay: 00:02:00
  - data: {}
    service: script.xiaomi_gateway_alarm_stop
  initial_state: false
  mode: single
- id: '1542650541048'
  alias: 'Xiaomi Staubsauger: Benachrichtigung Sensor kritisch'
  trigger:
  - below: '2'
    platform: numeric_state
    entity_id: sensor.xiaomi_vacuum_sensor_dirty_left
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition:
  - condition: device
    device_id: d395d1f0c190ee5b6e5c1bb4424f0515
    domain: vacuum
    entity_id: vacuum.roborock_vacuum
    type: is_docked
  action:
  - data:
      message: 'Sensor reinigen: {{ states.sensor.xiaomi_vacuum_sensor_dirty_left.state
        }} h übrig'
      notification_id: xiaomi_sensor
      title: Xiaomi StaubRobo
    service: persistent_notification.create
  mode: single
- id: '1543619209115'
  alias: 'Startup: Restart Services'
  trigger:
  - event: start
    platform: homeassistant
  condition: []
  action:
  - service: homeassistant.update_entity
    data:
      entity_id: sensor.hacs
  - service: hassio.addon_stdin
    data:
      addon: 15d21743_samba_backup
      input: restore-sensor
  - delay: 00:01:30
  - service: automation.reload
    data: {}
  mode: single
- id: '1548418632803'
  alias: 'Xiaomi Staubsauger: Zähler zurücksetzen'
  trigger:
  - entity_id: vacuum.roborock_vacuum
    from: docked
    platform: state
    to: cleaning
  condition: []
  action:
  - data:
      entity_id: counter.xiaomo_errors
    service: counter.reset
- id: '1550439982602'
  alias: 'Xiaomi Staubsauger: Starten nach Push'
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: START_VACUUM
  - platform: event
    event_type: ios.action_fired
    event_data:
      actionName: start_vacuum
  condition: []
  action:
  - data:
      entity_id: vacuum.roborock_vacuum
    service: vacuum.start
  - data:
      entity_id: vacuum.roborock_vacuum
      fan_speed: Turbo
    service: vacuum.set_fan_speed
  mode: single
- id: '1563024961089'
  alias: 'Xiaomi Staubsauger: Hauptbürste wechseln'
  trigger:
  - below: '3'
    platform: numeric_state
    entity_id: sensor.xiaomi_vacuum_main_brush_left
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition:
  - condition: device
    device_id: d395d1f0c190ee5b6e5c1bb4424f0515
    domain: vacuum
    entity_id: vacuum.roborock_vacuum
    type: is_docked
  action:
  - data:
      message: 'Hauptbürste reinigen: {{ states.sensor.xiaomi_vacuum_main_brush_left.state
        }} h übrig'
      notification_id: xiaomi_brush
      title: Xiaomi StaubRobo Hauptbürste
    service: persistent_notification.create
- id: '1564908105933'
  alias: 'Benachrichtigung: RAM zu hoch'
  trigger:
  - above: 75
    entity_id: sensor.memory_use_percent
    platform: numeric_state
    for:
      hours: 0
      minutes: 15
      seconds: 0
  condition: []
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'RAM Auslastung zu hoch: {{ states.sensor.memory_use_percent.state
        }} % '
      notification_id: pi
      title: Raspi
    service: script.notify_script
  mode: single
- id: '1568628137654'
  alias: 'Xiaomi Staubsauger: Benachrichtigung Filter kritisch'
  trigger:
  - below: '2'
    platform: numeric_state
    entity_id: sensor.xiaomi_vacuum_filter_left
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition:
  - condition: device
    device_id: d395d1f0c190ee5b6e5c1bb4424f0515
    domain: vacuum
    entity_id: vacuum.roborock_vacuum
    type: is_docked
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'Filter wechseln: {{ states.sensor.xiaomi_vacuum_filter_left.state
        }} h übrig'
      notification_id: xiaomi_filter
      title: Xiaomi StaubRobo
    service: script.notify_script
  mode: single
- id: '1570440017469'
  alias: 'iOS: Badge zurücksetzen'
  trigger:
  - event_data:
      sourceDeviceName: iPhone14Pro
    event_type: ios.became_active
    platform: event
  condition: []
  action:
  - service: script.notify_clean_badge
    data: {}
  mode: single
- id: '1571050762220'
  alias: 'Xiaomi Staubsauger: Fehler Hinweis'
  trigger:
  - entity_id: group.presence
    platform: state
    to: home
    for: 00:02:00
  condition:
  - condition: state
    entity_id: vacuum.roborock_vacuum
    state: error
  action:
  - data:
      entity_id: vacuum.roborock_vacuum
    service: vacuum.locate
  mode: single
- id: '1574071080398'
  alias: 'Entertainment: Steckdosenleiste ausschalten'
  description: ''
  trigger:
  - at: 00:01
    platform: time
  - platform: state
    for:
      hours: 0
      minutes: 15
      seconds: 0
    entity_id:
    - remote.harmony_hub
    to: 'off'
  condition: []
  action:
  - delay: 00:01:00
  - data:
      entity_id: switch.steckdosenleiste
    service: switch.turn_off
  mode: restart
- id: '1578168461545'
  alias: 'Benachrichtigung: Snapshot Fehler'
  trigger:
  - platform: state
    entity_id: sensor.samba_backup
    attribute: total_backups_failed
  action:
  - service: persistent_notification.create
    data:
      message: Snapshot Fehler
      title: Snapshot Fehler
      notification_id: snapshot_error
  mode: single
- id: '1584265149079'
  alias: 'Benachrichtigung: CPU Temp zu hoch'
  description: ''
  trigger:
  - above: '75'
    entity_id: sensor.cpu_temperature
    for:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
    platform: numeric_state
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'CPU Temp zu hoch: {{ states ( "sensor.cpu_temperature" ) }}°'
      notification_id: cpu_temp
      title: CPU Temp
    service: script.notify_script
- id: '1603141534875'
  alias: 'Licht: Nachtlicht Helligkeit'
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 9c9d0c210c7d11eba05f8b9968791799
    entity_id: light.yeelight_bslamp1_0x0000000005451cd6
    domain: light
  condition: []
  action:
  - scene: scene.nachtlicht_hell
  mode: single
- id: '1604932069752'
  alias: 'Benachrichtigung: Wohnungstür offen'
  description: ''
  trigger:
  - platform: state
    to: 'on'
    entity_id: binary_sensor.fenster_turkontaktsensor
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 30
      milliseconds: 0
  - condition: state
    state: not_home
    entity_id: person.wolfgang
    for: 00:03:00
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: Wohnungstür geöffnet
      notification_id: alert
      title: Bewegungsmelder
    service: script.notify_script
  mode: restart
- id: '1584265149080'
  alias: 'Benachrichtigung: CPU Auslastung zu hoch'
  description: ''
  trigger:
  - above: '50'
    for: 00:10:00
    platform: numeric_state
    entity_id: sensor.processor_use
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'CPU Auslastung zu hoch: {{ states ( "sensor.processor_use" ) }}%'
      notification_id: cpu
      title: CPU Auslastung
    service: script.notify_script
  mode: single
- id: '1607432908571'
  alias: 'Entertainment: Steckdosenleiste einschalten'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - remote.harmony_hub
    to: 'on'
  condition: []
  action:
  - type: turn_on
    device_id: d140a8b718ed69ff5c2ae91ab0a9f5d7
    entity_id: switch.steckdosenleiste
    domain: switch
  mode: single
- id: '1612343173377'
  alias: 'iOS: Telefonat'
  description: ''
  trigger:
  - platform: event
    event_type: ios.action_fired
    event_data:
      actionName: phonecall
  condition: []
  action:
  - service: script.sonos_stopp
    data: {}
  mode: single
- id: '1614106691093'
  alias: 'Sonos: Lautstärke anpassen'
  description: ''
  trigger:
  - platform: event
    event_type: call_service
    event_data:
      domain: media_player
      service: volume_up
  - platform: event
    event_type: call_service
    event_data:
      domain: media_player
      service: volume_down
  condition:
  - condition: state
    entity_id: input_boolean.sync_volume
    state: 'on'
  - condition: template
    value_template: '{{ trigger.event.data.service_data.entity_id != "media_player.harman_kardon_avr"}}'
  action:
  - service: script.sonos_set_volume
    data:
      sonos_id: '{{ trigger.event.data.service_data.entity_id | regex_replace(find="media_player.",
        replace="") }}'
  mode: queued
  max: 10
- id: '1615913010852'
  alias: Restart Wireguard
  description: nach IP Wechsel Wireguard neustarten
  trigger:
  - platform: state
    entity_id: sensor.fritz_box_7590_external_ip
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - service: hassio.addon_restart
    data:
      addon: a0d7b954_wireguard
  mode: single
- id: '1620892776475'
  alias: 'Xiaomi Staubsauger: Abwesenheit'
  description: ''
  trigger:
  - entity_id: group.presence
    platform: state
    to: not_home
  condition:
  - after: 07:00
    before: '19:00'
    condition: time
  action:
  - service: notify.all_ios_devices
    data:
      message: Staubsauger starten?
      data:
        actions:
        - action: START_VACUUM
          title: Starten
  mode: single
- id: '1629099375854'
  alias: 'Benachrichtigung: HP Spectre VPN'
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.wireguard_hpspectre
    to: Verbunden
  condition:
  - condition: state
    entity_id: device_tracker.hp_spectre
    state: home
  action:
  - service: input_boolean.turn_on
    target:
      entity_id: input_boolean.persistent_notification
  - data:
      message: HP Spectre mit VPN verbunden
      notification_id: vpn
      title: VPN HP Spectre
    service: script.notify_script
  mode: single
- id: '1630241435170'
  alias: 'Kaffeemaschine: Benachrichtigung Steckdose'
  description: ''
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.kaffeemaschine
  condition: []
  action:
  - service: notify.all_ios_devices
    data:
      message: Kaffeemaschine ist noch an
      data:
        actions:
        - action: SWITCH_OFF_COFFEE
          title: Steckdose ausschalten
        tag: Kaffeemaschine
  - service: timer.start
    data:
      duration: 00:10:00
    target:
      entity_id: timer.kaffeemaschine
  - service: input_boolean.turn_on
    target:
      entity_id: input_boolean.kaffeemaschine_steckdose
    data: {}
  mode: single
- id: '1630241702798'
  alias: 'Kaffeemaschine: Steckdose aus nach Push'
  description: ''
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: SWITCH_OFF_COFFEE
  condition: []
  action:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.steckdose_3
  mode: single
- id: '1610972932012'
  alias: 'Kaffeemaschine: ein/ausschalten'
  description: ''
  trigger:
  - device_id: a955261a32066a37020dbc5ffa64788c
    domain: deconz
    platform: device
    type: remote_button_short_press
    subtype: turn_on
  condition: []
  action:
  - service: switch.toggle
    target:
      entity_id: switch.on_off_plug_in_unit_12
  mode: single
- id: '1630242296075'
  alias: 'Kaffeemaschine: Timer'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - switch.steckdose_3
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        state: 'on'
        entity_id: switch.steckdose_3
      sequence:
      - service: timer.start
        data:
          duration: 00:20:00
        target:
          entity_id: timer.kaffeemaschine
    - conditions:
      - condition: state
        state: 'off'
        entity_id: switch.steckdose_3
      sequence:
      - service: timer.cancel
        target:
          entity_id: timer.kaffeemaschine
        data: {}
      - service: input_boolean.turn_off
        target:
          entity_id: input_boolean.kaffeemaschine_steckdose
        data: {}
      - service: notify.all_ios_devices
        data:
          message: clear_notification
          data:
            tag: Kaffeemaschine
    default: []
  mode: single
- id: '1630350328215'
  alias: 'Batterie: Niedriger Batteriestand'
  description: ''
  use_blueprint:
    path: tanzerw/low_battery.yaml
    input:
      exclude:
        entity_id:
        - sensor.iphone11pro_battery_level
        - sensor.iphone11pro_battery_state
        - sensor.ipad_battery_level
      time: '10:00:00'
      actions:
      - service: input_boolean.turn_on
        target:
          entity_id: input_boolean.persistent_notification
      - data:
          message: 'Batteriewarnung für: {{sensors}}'
          notification_id: battery
          title: Batteriewarnung
        service: script.notify_script
      - service: input_boolean.turn_on
        target:
          entity_id: input_boolean.batteriewarnung
      threshold: 5
- id: '1631286411270'
  alias: 'Kaffeemaschine: Ausschalten nach 20 Minuten'
  description: ''
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.kaffeemaschine
  condition: []
  action:
  - service: switch.turn_off
    target:
      entity_id: switch.on_off_plug_in_unit_12
  mode: single
- id: '1634394580227'
  alias: 'DS118: Benachrichtigung shutdown'
  description: ''
  trigger:
  - platform: state
    to: 'off'
    for:
      hours: 0
      minutes: 3
      seconds: 0
    entity_id:
    - switch.ds118
  condition: []
  action:
  - service: notify.all_ios_devices
    data:
      data:
        actions:
        - action: DS118_TURN_ON
          title: DS118 einschalten
      message: DS118 wurde herruntergefahren
  mode: single
- id: '1634394824204'
  alias: 'DS118: Einschalten nach Push'
  description: Schaltet alle Lichter und Steckdosen aus und aktiviert den Bewegungssensor
  trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: DS118_TURN_ON
  condition: []
  action:
  - service: switch.turn_on
    target:
      entity_id: switch.ds118
  mode: single
- id: '1634457704422'
  alias: Abwesenheitsmodus
  description: ''
  trigger:
  - platform: state
    entity_id:
    - group.presence
    for:
      hours: 0
      minutes: 0
      seconds: 0
    to: not_home
  - platform: state
    entity_id: group.presence
    to: home
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: group.presence
        state: not_home
        for:
          hours: 0
          minutes: 0
          seconds: 0
      - condition: state
        entity_id: input_boolean.abwesenheitsmodus
        state: 'off'
      sequence:
      - service: notify.all_ios_devices
        data:
          data:
            actions:
            - action: TURN_ON_ABSENCE
              title: Abweseheitsmodus aktivieren
          message: Niemand ist mehr zu Hause
      - service: automation.turn_on
        data: {}
        target:
          entity_id: automation.benachrichtigung_wohnungstur_offen
    - conditions:
      - condition: state
        entity_id: group.presence
        state: home
      sequence:
      - data: {}
        service: automation.turn_off
        target:
          entity_id:
          - automation.benachrichtigung_wohnungstur_offen
      - service: input_boolean.turn_off
        data: {}
        target:
          entity_id: input_boolean.abwesenheitsmodus
    default: []
  mode: restart
- id: '1639749213579'
  alias: 'Babykamera: Surveillance'
  description: ''
  trigger:
  - platform: state
    entity_id: switch.steckdose_1
  condition: []
  action:
  - choose:
    - conditions:
      - condition: device
        type: is_on
        device_id: cca9aaba4959ef500db7488b34736ac6
        entity_id: switch.steckdose_1
        domain: switch
      sequence:
      - service: shell_command.ds118_surveillance_start
    - conditions:
      - condition: device
        type: is_off
        device_id: cca9aaba4959ef500db7488b34736ac6
        entity_id: switch.steckdose_1
        domain: switch
      sequence:
      - service: shell_command.ds118_surveillance_stop
    default: []
  mode: single
- id: '1644489340800'
  alias: 'Sonos: unjoin'
  description: ''
  trigger:
  - platform: time
    at: 01:00
  condition: []
  action:
  - service: media_player.unjoin
    data: {}
    target:
      entity_id: media_player.schlafzimmer
  mode: single
- id: '1644583530100'
  alias: 'Sonos: Touch Schlafzimmer'
  description: ''
  trigger:
  - platform: time
    id: aus
    at: '22:30'
  - platform: time
    at: 08:00
    id: an
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: aus
      sequence:
      - service: switch.turn_off
        data: {}
        target:
          entity_id: switch.sonos_schlafzimmer_touch_controls
    - conditions:
      - condition: trigger
        id: an
      sequence:
      - service: switch.turn_on
        data: {}
        target:
          entity_id: switch.sonos_schlafzimmer_touch_controls
    default: []
  mode: single
- id: '1648892553661'
  alias: 'Sonos: Küche'
  description: ''
  trigger:
  - platform: event
    event_type: deconz_event
    event_data:
      id: tradfri_fernbedienung
      unique_id: 5c:02:72:ff:fe:40:3a:25
      event: 1002
      device_id: 055f6416a4714103c74a8e75080ec589
    id: bayern_1
  - platform: event
    event_type: deconz_event
    event_data:
      id: tradfri_fernbedienung
      unique_id: 5c:02:72:ff:fe:40:3a:25
      event: 3002
      device_id: 055f6416a4714103c74a8e75080ec589
    id: br24
  - platform: event
    event_type: deconz_event
    event_data:
      id: tradfri_fernbedienung
      unique_id: 5c:02:72:ff:fe:40:3a:25
      event: 2002
      device_id: 055f6416a4714103c74a8e75080ec589
    id: bayern2
  - platform: event
    event_type: deconz_event
    event_data:
      id: tradfri_fernbedienung
      unique_id: 5c:02:72:ff:fe:40:3a:25
      event: 4002
      device_id: 055f6416a4714103c74a8e75080ec589
    id: leiser
  - platform: event
    event_type: deconz_event
    event_data:
      id: tradfri_fernbedienung
      unique_id: 5c:02:72:ff:fe:40:3a:25
      event: 5002
      device_id: 055f6416a4714103c74a8e75080ec589
    id: lauter
  - platform: event
    event_type: deconz_event
    event_data:
      id: tradfri_fernbedienung
      unique_id: 5c:02:72:ff:fe:40:3a:25
      event: 1001
      device_id: 055f6416a4714103c74a8e75080ec589
    id: stop
  - platform: event
    event_type: deconz_event
    event_data:
      id: dimmschalter_whz
      unique_id: 00:17:88:01:10:6f:26:73
      event: 2002
      device_id: 93e695d3c6444a3632bca4fa556f8c04
    id: dimmer
  condition: []
  action:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: trigger
          id: bayern_1
        - condition: trigger
          id: dimmer
      sequence:
      - choose:
        - conditions:
          - condition: device
            device_id: 2094b86c2a0d860eeddf623406678e39
            domain: media_player
            entity_id: media_player.kuche
            type: is_playing
          sequence:
          - service: media_player.media_pause
            data: {}
            target:
              device_id: 2094b86c2a0d860eeddf623406678e39
        default:
        - service: script.sonos_kuche_bayern_1
          data: {}
    - conditions:
      - condition: trigger
        id: br24
      sequence:
      - service: script.sonos_kuche_bayern_1_2
        data: {}
    - conditions:
      - condition: trigger
        id: bayern2
      sequence:
      - service: script.sonos_kuche_bayern_2
        data: {}
    - conditions:
      - condition: trigger
        id: leiser
      sequence:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.kuche
    - conditions:
      - condition: trigger
        id: lauter
      sequence:
      - service: media_player.volume_up
        data: {}
        target:
          entity_id: media_player.kuche
    - conditions:
      - condition: trigger
        id: stop
      sequence:
      - service: media_player.turn_off
        data: {}
        target:
          entity_id: media_player.kuche
    default: []
  mode: single
- id: '1651490190900'
  alias: 'Licht: Bewegung Flur (neu)'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.bewegungsmelder
    to: 'on'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: time
        after: 07:00:00
        before: '19:00:00'
      sequence:
      - service: scene.turn_on
        data: {}
        target:
          entity_id: scene.flur_tageslicht
    default:
    - service: scene.turn_on
      data: {}
      target:
        entity_id: scene.flur_nachtlicht
  - repeat:
      until:
      - condition: state
        entity_id: binary_sensor.bewegungsmelder
        state: 'off'
      sequence:
      - delay:
          hours: 0
          minutes: 3
          seconds: 0
          milliseconds: 0
      - condition: state
        state: 'off'
        entity_id: binary_sensor.bewegungsmelder
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.flur
  mode: restart
- id: '1652181291403'
  alias: 'Licht: Bewegung Küche (neu)'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.tradfri_motion_sensor
    to: 'on'
  condition:
  - condition: state
    entity_id: sun.sun
    state: below_horizon
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.kuche
  - repeat:
      until:
      - condition: state
        state: 'off'
        entity_id: binary_sensor.tradfri_motion_sensor
      sequence:
      - delay:
          hours: 0
          minutes: 3
          seconds: 0
          milliseconds: 0
      - condition: state
        entity_id: binary_sensor.tradfri_motion_sensor
        state: 'off'
        for:
          hours: 0
          minutes: 1
          seconds: 0
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.kuche
  mode: restart
- id: '1655032424438'
  alias: 'Benachrichtigung:  Laptop Erlau online'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.wireguard_laptoperlau
    to: Verbunden
  condition:
  - condition: time
    after: 08:00:00
    before: '21:00:00'
  action:
  - data:
      entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: Laptop Erlau ist online
      notification_id: vpn_update
      title: VPN
    service: script.notify_script
  mode: single
- id: '1658949383573'
  alias: 'Internet: Neustart'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.fritz_box_7590_connection
    for:
      hours: 0
      minutes: 30
      seconds: 0
    from: 'on'
  condition: []
  action:
  - device_id: 36a8d6e82781d3f1100027ab2637239a
    domain: button
    entity_id: button.fritz_box_7590_reboot
    type: press
  - repeat:
      until:
      - condition: state
        state: 'on'
        entity_id: binary_sensor.fritz_box_7590_connection
      sequence:
      - delay:
          hours: 1
          minutes: 0
          seconds: 0
          milliseconds: 0
      - device_id: 36a8d6e82781d3f1100027ab2637239a
        domain: button
        entity_id: button.fritz_box_7590_reconnect
        type: press
  mode: single
- id: '1664976725414'
  alias: 'DS118: Raspi Backup'
  description: ''
  trigger:
  - platform: time
    at: 02:00:00
  condition:
  - condition: time
    weekday:
    - wed
  - condition: state
    entity_id: switch.ds118
    state: 'off'
  action:
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.ds118
  mode: single
- id: '1666460813767'
  alias: 'Benachrichtigung: Swap zu hoch'
  description: ''
  trigger:
  - above: 40
    for:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
    platform: numeric_state
    entity_id: sensor.swap_use_percent
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: 'Swap Auslastung zu hoch: {{ states ( "sensor.swap_use_percent" ) }}%'
      notification_id: swap
      title: swap Auslastung
    service: script.notify_script
  mode: single
- id: '1667402945500'
  alias: 'Benachrichtigung: Geschirrspüler fertig'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.402060518382006939_bsh_common_status_operationstate
    to: BSH.Common.EnumType.OperationState.Finished
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.persistent_notification
    service: input_boolean.turn_on
  - data:
      message: Geschirrspüler fertig
      notification_id: dish_washer
      title: Geschirrspüler
    service: script.notify_script
  mode: single
- id: '1667588047117'
  alias: 'Licht: Nachtlicht'
  description: ''
  trigger:
  - device_id: 675814098aa35a2beec63d074cf3616f
    domain: deconz
    platform: device
    type: remote_button_short_press
    subtype: left
  condition: []
  action:
  - service: light.toggle
    data: {}
    target:
      entity_id: light.yeelight_bslamp1_0x0000000005451cd6
  mode: single
- id: '1668452168948'
  alias: 'Harmony: Set Bass'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - remote.harmony_hub
    attribute: current_activity
    to: AirPlay
    for:
      hours: 0
      minutes: 0
      seconds: 15
  - platform: state
    entity_id:
    - remote.harmony_hub
    attribute: current_activity
    to: Plattenspieler
    for:
      hours: 0
      minutes: 0
      seconds: 15
  condition: []
  action:
  - service: script.harmony_tone
    data: {}
  mode: single
- id: '1670512862313'
  alias: 'Entertainment: Fix FireTV'
  description: ''
  trigger:
  - platform: state
    entity_id:
    - remote.harmony_hub
    attribute: current_activity
    to: Fire TV
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition:
  - condition: state
    entity_id: media_player.samsung_q60aa_43_tv
    state: 'off'
  action:
  - service: media_player.turn_on
    data: {}
    target:
      entity_id: media_player.samsung_q60aa_43_tv
  mode: single
- id: '1671118865832'
  alias: 'Benachrichtigung: Docker Updates'
  description: ''
  use_blueprint:
    path: mdegat01/update_notifications.yaml
    input:
      reminder_hours: None
      update_entities:
      - update.wud_container_local_deconz
      - update.wud_container_local_dockerproxy
      - update.wud_container_local_mariadb
      - update.wud_container_local_nginx_proxy_manager
      - update.wud_container_local_pihole
      - update.wud_container_local_vaultwarden
      - update.wud_container_local_wud
      mobile_app_device: ef3094ac8106c9a744660ee38c6bf27b
      send_to_ha: true
      take_backup: false
