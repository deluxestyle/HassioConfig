resources:
  - url: /community_plugin/mini-media-player/mini-media-player-bundle.js
    type: module
  - url: /community_plugin/lovelace-fold-entity-row/fold-entity-row.js
    type: js
  - url: /community_plugin/custom-header/custom-header.js
    type: module
  - url: /community_plugin/vertical-stack-in-card/vertical-stack-in-card.js
    type: js
  - url: /community_plugin/button-card/button-card.js
    type: module
  - url: /community_plugin/group-card/group-card.js
    type: js  
  - url: /community_plugin/lovelace-card-mod/card-mod.js
    type: module
  - url: /community_plugin/lovelace-multiple-entity-row/multiple-entity-row.js
    type: js
  - url: /community_plugin/lovelace-card-tools/card-tools.js
    type: js
  - url: /local/github/thomasloven/time-input-row.js?track=true 
    type: js
  - url: /local/tiles-card.js?track=true
    type: js
  - url: /community_plugin/lovelace-card-mod/card-mod.js
    type: module
  - url: /community_plugin/lovelace-auto-entities/auto-entities.js
    type: js
  - url: /local/simple-thermostat_wt/simple-thermostat.js?v=wt0.03
    type: module
  - url: /community_plugin/mini-graph-card/mini-graph-card-bundle.js
    type: module

# -----------------------------
custom_header:
  compact_mode: true
  chevrons: false
  hide_config: true
  exceptions:
    - conditions:
        user: anita
      config:
        hide_tabs: 7

# -----------------------------
## music player
x-music-player: &music-player
  icon: 'mdi:speaker-wireless'
  hide:
    power: true
    source: false
    progress: true
  group: true
  #artwork: none
  source: full
  more_info: false
  sonos:
    show_group_count: true
    sync_volume: true
    entities:
      - entity_id: media_player.schlafzimmer
        name: Sonos Schlafzimmer
      - entity_id: media_player.bad
        name: Sonos Bad
      - entity_id: media_player.kuche
        name: Sonos Küche

## vacuum_buttons
x-vacuum-buttons: &vacuum-buttons
  #color: auto
  show_name: false
  color_type: icon
  color: rgb(68, 115, 158)
  entity: vacuum.xiaomi_vacuum_cleaner
  size: 60%

## buttons_general
x-buttons_general: &buttons_general
  global_settings:
    align: 'center middle'
    orientation: horizontal
    label:
      color:
        value: white
    label_sec:
      color:
        value: white
    icon:
      color:
        value: white

##climate popup
x-popup-climate: &popup-climate
  style: |
    ha-card {
      --ha-card-box-shadow: 'none';
      --st-font-size-sensors: 14px;
      --st-font-size-xl: 40px;
    }
  step_size: 0.5
  name: false
  control :
    _icons: false

## mini-graph
x-mini-graph: &mini-graph
  font_size: 75
  line_width: 2
  font_size_header: 12
  hour24: true
  height: 100
# -----------------------------

# -----------------------------
## Views
title: Home
views:
##### Licht #####
  - title: Licht
    id: light
    icon: mdi:ceiling-light
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - light.lights_living_room
          - input_select.scenes_living_room
          - type: custom:fold-entity-row
            head: 
              type: section
              label: Lampen
            padding: 5
            entities:
              - light.decke
              - light.tisch
              - light.leselampe
      - type: entities
        show_header_toggle: false
        entities:
          - entity: light.lights_bed_room
            tap_action: 
              action: none
          - input_select.scenes_bed_room
          - type: custom:fold-entity-row
            head:
              type: section
              label: Lampen
            padding: 5
            entities:
              - light.nachttischlampe_wolfgang
              - light.nachttischlampe_anita
              - light.schlafzimmer
      - type: entities
        show_header_toggle: false
        entities:
          - entity: light.sonoff_office
            tap_action: 
              action: none
      - type: entities
        show_header_toggle: false
        entities:
          - entity: light.lights_kitchen
            tap_action: 
              action: none
          - type: custom:fold-entity-row
            head: 
              type: section
              label: Lampen
            padding: 5
            entities:
              - light.deckenlicht
              - light.steckdose_2
              - light.steckdose_4
      - type: entities
        show_header_toggle: false
        entities:
          - light.gateway_light_7811dcb258d1
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:tiles-card
            card_settings:
              columns: 1
              row_height: 45px
              padding: 10px
            <<: *buttons_general
            entities:
              - entity: light.lights_all
                label: Licht
                row: 1
                column: 1
                background:
                  value_on: '#03A9F4'
                  value_off: '#999999'

##### Heizung #####
  - title: Heizung
    id: radiator
    icon: mdi:radiator
    cards:
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:tiles-card
            card_settings:
              columns: 1
              row_height: 45px
              padding: 10px
            <<: *buttons_general
            entities:
              - entity: switch.radiator_on_off
                label: Heizung
                row: 1
                column: 1
                background:
                  value_on: '#03A9F4'
                  value_off: '#999999'
      - type: entities
        show_header_toggle: false
        entities:
          - entity: climate.fritz_thermostat
            name: Bad (fritz)
            tap_action:
              action: call-service
              service: browser_mod.popup
              service_data:
                deviceID: this
                title: Heizung Bad
                card:
                  type: entities
                  entities: 
                    - type: 'custom:simple-thermostat'
                      entity: climate.fritz_thermostat
                      <<: *popup-climate
          - entity: sensor.temperature_158d00023258bd
            name: Thermometer
            type: custom:multiple-entity-row
            primary:
              entity: sensor.humidity_158d00023258bd
              name: false
          - entity: binary_sensor.door_window_sensor_158d00022f13a0
            name: Fenster
          - type: custom:fold-entity-row
            head:
              type: section
              label: Timer
            padding: 5
            entities:
              - entity: automation.heizung_bad_timer
                name: Bad Timer
              - entity: input_datetime.radiator_bath_1
                name: Startzeit
                type: custom:time-input-row
      - type: entities
        show_header_toggle: false
        entities:
          - entity: climate.oeq1696358
            name: Wohnzimmer
            tap_action:
              action: call-service
              service: browser_mod.popup
              service_data:
                deviceID: this
                title: Heizung Wohnzimmer
                card:
                  type: entities
                  entities: 
                    - type: 'custom:simple-thermostat'
                      entity: climate.oeq1696358
                      <<: *popup-climate
          - entity: sensor.temperature_158d0001b8c998
            name: Thermometer
            type: custom:multiple-entity-row
            primary:
              entity: sensor.humidity_158d0001b8c998
              name: false
          - type: custom:fold-entity-row
            head:
              type: section
              label: Mehr
            padding: 5
            entities:
              - switch.radiator_living_room_keylock
              - sensor.valve_living_room
      - type: entities
        show_header_toggle: false
        entities:
          - entity: climate.oeq1696369
            name: Schlafzimmer
            tap_action:
              action: call-service
              service: browser_mod.popup
              service_data:
                deviceID: this
                title: Heizung Schlafzimmer
                card:
                  type: entities
                  entities: 
                    - type: 'custom:simple-thermostat'
                      entity: climate.oeq1696369
                      <<: *popup-climate
          - entity: sensor.temperature_158d0001b8c96c
            name: Thermometer
            type: custom:multiple-entity-row
            primary:
              entity: sensor.humidity_158d0001b8c96c
              name: false
          - type: custom:fold-entity-row
            head:
              type: section
              label: Mehr
            padding: 5
            entities:
              - switch.radiator_bed_room_keylock
              - sensor.valve_bed_room
      - type: entities
        show_header_toggle: false
        entities:
          - entity: climate.int0000002
            name: Büro
            tap_action:
              action: call-service
              service: browser_mod.popup
              service_data:
                deviceID: this
                title: Heizung Büro
                card:
                  type: entities
                  entities: 
                    - type: 'custom:simple-thermostat'
                      entity: climate.int0000002
                      <<: *popup-climate
          - entity: sensor.oeq1667238_temperature
            name: Thermometer
            type: custom:multiple-entity-row
            primary:
              entity: sensor.oeq1667238_humidity
              name: false
          - type: custom:fold-entity-row
            head:
              type: section
              label: Mehr
            padding: 5
            entities:
              - switch.radiator_office_keylock
              - sensor.valve_office
      - type: entities
        show_header_toggle: false
        entities:
          - entity: climate.oeq1701003
            name: Küche
            tap_action:
              action: call-service
              service: browser_mod.popup
              service_data:
                deviceID: this
                title: Heizung Küche
                card:
                  type: entities
                  entities: 
                    - type: 'custom:simple-thermostat'
                      entity: climate.oeq1701003
                      <<: *popup-climate
          - entity: sensor.temperature_158d0002239fb5
            name: Thermometer
            type: custom:multiple-entity-row
            primary:
              entity: sensor.humidity_158d0002239fb5
              name: false
          - type: custom:fold-entity-row
            head:
              type: section
              label: Mehr
            padding: 5
            entities:
              - entity: switch.radiator_homematic_keylock
                name: Tastensperre
              - entity: sensor.valve_homematic
                name: Ventil
      - type: entities
        show_header_toggle: false
        entities: 
          - sensor.dark_sky_temperature
          - type: custom:fold-entity-row
            head:
              type: section
              label: Automatisierung
            padding: 5
            entities:
              - input_boolean.automation_radiator
              - automation.heizung_abwesenheitsschaltung
              - automation.benachrichtigung_luftfeuchtigkeit

#### Staubsauger #####
  - title: Staubsauger
    id: vacuum
    icon: mdi:robot-vacuum
    cards:
      - type: custom:vertical-stack-in-card
        cards:
          - type: entities
            show_header_toggle: false
            entities:
              - vacuum.xiaomi_vacuum_cleaner
              - sensor.xiaomi_vacuum_sensor_battery
              - type: section
          - type: horizontal-stack
            cards:
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                icon: mdi:play
                <<: *vacuum-buttons
                tap_action:
                  action: call-service
                  service: vacuum.start
                  service_data:
                    entity_id: vacuum.xiaomi_vacuum_cleaner
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                icon: mdi:pause
                <<: *vacuum-buttons
                tap_action:
                  action: call-service
                  service: vacuum.pause
                  service_data:
                    entity_id: vacuum.xiaomi_vacuum_cleaner
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                icon: mdi:home
                <<: *vacuum-buttons
                tap_action:
                  action: call-service
                  service: vacuum.return_to_base
                  service_data:
                    entity_id: vacuum.xiaomi_vacuum_cleaner
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                icon: mdi:map-marker
                <<: *vacuum-buttons
                tap_action:
                  action: call-service
                  service: vacuum.locate
                  service_data:
                    entity_id: vacuum.xiaomi_vacuum_cleaner
              - type: "custom:button-card"
                color_type: blank-card
          - type: entities
            show_header_toggle: false
            entities:
              - type: custom:fold-entity-row
                head:
                  type: section
                  label: Automatisierung
                padding: 5
                entities:
                  - entity: automation.xiaomi_staubsauger_abwesenheit
                    name: Abwesenheit
                  - entity: automation.xiaomi_staubsauger_taglich_saugen
                    name: Täglich saugen
              - type: custom:fold-entity-row
                head:
                  type: section
                  label: Zonen (Räume)
                padding: 5
                entities:
                  - input_select.vacuum_rooms
              - type: custom:fold-entity-row
                head:
                  type: section
                  label: Wartung
                padding: 5
                entities:
                  - entity: automation.xiaomi_staubsauger_neustart
                    name: Neustarten (Bürste blockiert)
                  - entity: automation.xiaomi_staubsauger_error_stop
                    name: Deaktivieren (b. Fehler)
                  - counter.xiaomo_errors
                  - type: section
                  - type: custom:fold-entity-row
                    head: sensor.xiaomi_vacuum_side_brush_left
                    padding: 5
                    entities:
                      - entity: script.1547995869377
                        name: Bürste gewechselt
                  - type: custom:fold-entity-row
                    head: sensor.xiaomi_vacuum_sensor_dirty_left
                    padding: 5
                    entities:
                      - entity: script.1547995682348
                        name: Sensor gereinigt
                      - entity: automation.xiaomi_staubsauger_sensor_kritisch
                        name: Sensor kritisch
                  - type: custom:fold-entity-row
                    head: sensor.xiaomi_vacuum_main_brush_left
                    padding: 5
                    entities: 
                      - entity: script.1547995909810
                        name: Bürste gewechselt
                  - type: custom:fold-entity-row
                    head: sensor.xiaomi_vacuum_filter_left
                    padding: 5
                    entities:
                      - entity: script.1547995832032
                        name: Filter gereinigt
                      - entity: automation.xiaomi_staubsauger_filter_kritisch
                        name: Filter kritisch
              - type: custom:fold-entity-row
                head:
                  type: section
                  label: Benachrichtigungen
                padding: 5
                entities:
                  - entity: automation.xiaomi_staubsauger_fehler
                    name: Fehler
                  - entity: automation.xiaomi_staubsauger_fertig
                    name: Reinigung abgeschlossen
                  - entity: automation.xiaomi_staubsauger_gestartet
                    name: Staubsauger gestartet

##### Musik #####
  - title: Musik
    id: music
    icon: mdi:music-box-outline
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - type: custom:mini-media-player
            entity: media_player.schlafzimmer
            <<: *music-player
      - type: entities
        show_header_toggle: false
        entities:
          - type: custom:mini-media-player
            entity: media_player.bad
            <<: *music-player
      - type: entities
        show_header_toggle: false
        entities:
          - type: custom:mini-media-player
            entity: media_player.kuche
            <<: *music-player
      - type: entities
        show_header_toggle: false
        entities:
          - script.1532173931522
          - type: custom:fold-entity-row
            head:
              type: section
              label: Automatisierung
            padding: 5
            entities:
              - automation.sonos_starten
              - automation.sonos_stoppen
          - type: custom:fold-entity-row
            head:
              type: section
              label: Wecker
            padding: 5
            entities:
              - input_datetime.sonos_alarm
              - automation.sonos_wecker

##### Entertainment #####
  - title: Entertainment
    id: entertainment
    icon: mdi:theater
    cards:
      - type: custom:vertical-stack-in-card
        cards:
          - type: entities
            show_header_toggle: false
            entities:
              - sensor.remote_state
              - type: section
          - type: horizontal-stack
            cards:
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                entity: switch.tv_switch
                size: 70%
                show_name: false
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                entity: switch.music_switch
                size: 70%
                show_name: false
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                color_type: blank-card
              - type: "custom:button-card"
                icon: mdi:volume-minus
                color: rgb(68, 115, 158)
                size: 75%
                tap_action:
                  action: call-service
                  service: media_player.volume_down
                  service_data:
                    entity_id: media_player.harman_kardon_avr
              - type: "custom:button-card"
                icon: mdi:volume-plus
                color: rgb(68, 115, 158)
                size: 75%
                tap_action:
                  action: call-service
                  service: media_player.volume_up
                  service_data:
                    entity_id: media_player.harman_kardon_avr
              - type: custom:button-card
                color: rgb(68, 115, 158)
                size: 75%
                icon: mdi:volume-off
                tap_action:
                  action: call-service
                  service: script.toggle
                  service_data:
                    entity_id: script.1565444624817
              - type: "custom:button-card"
                color_type: blank-card
          - type: entities
            show_header_toggle: false
            entities:
              - type: custom:fold-entity-row
                head:
                  type: section
                  label: AVR 151
                padding: 5
                entities:
                  - input_select.avr_source

##### Steckdosen #####
  - title: Steckdosen
    id: socket
    icon: mdi:power-socket-eu
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - switch.wifi_steckdose
          - type: custom:fold-entity-row
            head: 
              type: section
              label: Verbrauchsdaten
            padding: 5
            entities:
              - entity: sensor.hs110_today_kwh
              - entity: sensor.hs110_total_kwh
              - entity: sensor.hs110_watts
              - entity: sensor.hs110_amps
              - entity: sensor.hs110_volts
      - type: entities
        show_header_toggle: false
        entities:
          - light.steckdose_3
      - type: entities
        show_header_toggle: false
        entities:
          - light.steckdose_5
      - type: entities
        show_header_toggle: false
        entities:
          - light.steckdose
                
##### Personen #####
  - title: Personen
    id: presence
    icon: mdi:account-multiple
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - person.wolfgang
          - person.anita
          - type: custom:fold-entity-row
            head:
              type: section
              label: Automatisierung
            padding: 5
            entities:
              - automation.abwesenheitsschaltung
              - automation.anwesenheitsschaltung
      - type: conditional
        conditions:
          - entity: device_tracker.hikam_4452
            state: "home"
        card:
          type: picture-entity
          entity: camera.ffmpeg
          title: Kamera
      - type: entities
        show_header_toggle: false
        entities:
          - binary_sensor.motion_sensor_158d00023e77cb
          - sensor.illumination_158d00023e77cb
          - type: section
          - automation.bewegungsmelder_alarm
          - script.1541097052191
          - type: section
          - automation.benachrichtigung_bewegung_erkannt

##### Auto ##### 
  - title: BMW X1
    id: bmw_x1
    icon: mdi:car-hatchback
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - device_tracker.x1_sdrive18i
          - input_boolean.car_map
          - type: custom:fold-entity-row
            head:
              type: section
              label: Übersicht
            padding: 5
            entities:
              - binary_sensor.x1_sdrive18i_door_lock_state
              - binary_sensor.x1_sdrive18i_lids
              - binary_sensor.x1_sdrive18i_windows
              - sensor.x1_sdrive18i_mileage
              - sensor.x1_sdrive18i_remaining_fuel
              - sensor.x1_sdrive18i_remaining_range_total
              - binary_sensor.x1_sdrive18i_lights_parking
              - binary_sensor.x1_sdrive18i_condition_based_services
              - binary_sensor.x1_sdrive18i_check_control_messages
      - type: conditional
        conditions:
          - entity: input_boolean.car_map
            state: "on"
        card:
          type: map
          default_zoom: 15
          aspect_ratio: 4:3
          entities:
            - entity: device_tracker.x1_sdrive18i
      - type: entities
        show_header_toggle: false
        entities:
          - entity: sensor.car_km_usage
            style: |
              :host {
                color: 
                {% if states("sensor.car_km_usage")|int > 99 %}
                  red
                {% endif %}
                ;
              }
          - type: custom:fold-entity-row
            head:
              type: section
              label: Mietdetails
            padding: 5
            entities:
              - sensor.car_days_in_use
              - sensor.car_km_threshold
              - automation.km_stand_kritisch    

##### System #####
  - title: System
    id: other
    icon: mdi:settings-outline
    cards:
      - type: entities
        show_header_toggle: false
        entities:
          - script.1570443737111
          - script.1570439203461
      - type: entities
        show_header_toggle: false
        entities:
          - automation.tagliches_backup_auto_backup
      - type: entities
        show_header_toggle: false
        entities:
          - automation.battery_persistent_notification
          - script.battery_persistent_notification_clear
          - type: custom:fold-entity-row
            head:
              type: section
              label: Batteriewerte
            padding: 5
            entities:
              - input_number.battery_alert_homematic
              - input_number.battery_alert_xiaomi
              - input_number.battery_alert_hue
          - type: custom:fold-entity-row
            head:
              type: section
              label: Batteriestatus
            padding: 5
            entities:
              - type: custom:fold-entity-row
                head: group.battery_status_homematic
              - type: custom:fold-entity-row
                head: group.battery_status_xiaomi
              - type: custom:fold-entity-row
                head: group.battery_status_hue
      - type: entities
        show_header_toggle: false
        entities:
          - sensor.online_time
          - sensor.fritz_netmonitor
      - type: glance
        columns: 4
        show_name: false
        entities:
          - entity: sensor.memory_use_percent
            name: Memory
          - entity: sensor.memory_use
            name: Memory
          - entity: sensor.disk_use_percent
            name: Disk
          - entity: sensor.disk_use
            name: Disk
          - entity: sensor.processor_use
            name: CPU
            icon: mdi:poll-box
          - entity: sensor.cpu_temperature
            name: CPU Temp
            icon: mdi:thermometer