
title: System
path: system
icon: mdi:cog-outline
type: custom:masonry-layout
layout:
  max_cols: 2
  height: auto
cards:  
  - type: custom:vertical-stack-in-card
    cards: 
      - type: glance
        columns: 4
        show_name: false
        entities:
          - entity: sensor.processor_use
            name: CPU   
            style: |
                :host {
                  color: 
                  {% if (states('sensor.processor_use')  | int(0)) > 30 %}
                    red
                  {% endif %}
                  ;
                }     
          - entity: sensor.memory_use_percent
            name: Memory %
          - entity: sensor.swap_use_percent
            name: Swap %
            icon: mdi:file-swap         
          - entity: sensor.disk_use_percent
            name: Disk %     
          - entity: sensor.cpu_temperature
            icon: mdi:thermometer
            name: CPU Temp
            style: |
                :host {
                  color: 
                  {% if (states('sensor.cpu_temperature')  | int(0)) > 65 %}
                    red
                  {% endif %}
                  ;
                }
          - entity: sensor.memory_use
            name: Memory
          - entity: sensor.swap_use
            name: Swap
            icon: mdi:file-swap  
          - entity: sensor.disk_use
            name: Disk 
          # - entity: sensor.influxdb_database_size
          #   icon: mdi:database-outline
          - entity: sensor.mariadb_database_size
            icon: mdi:database 
          # - entity: sensor.samba_backup
          #   icon: mdi:content-save-all
          #   tap_action:
          #     action: fire-dom-event
          #     browser_mod:
          #       service: browser_mod.popup
          #       data:
          #         title: Status
          #         style: |
          #           --popup-border-width: 0px;
          #           --ha-card-border-color: var(--popup-border-color);
          #         card_mod:
          #           !include ../includes/popups/popup_styles.yaml
          #         content:
          #           type: entities
          #           entities:
          #             - attribute: backups_local
          #               entity: sensor.samba_backup
          #               icon: 'mdi:file-outline'
          #               name: Local Backups
          #               type: attribute
          #             - attribute: backups_remote
          #               entity: sensor.samba_backup
          #               icon: 'mdi:file-move-outline'
          #               name: Remote Backups
          #               type: attribute
          #             - attribute: total_backups_succeeded
          #               entity: sensor.samba_backup
          #               icon: 'mdi:file-check-outline'
          #               name: Succeded Backups
          #               type: attribute
          #             - attribute: total_backups_failed
          #               entity: sensor.samba_backup
          #               icon: 'mdi:file-cancel-outline'
          #               name: Failed Backups
          #               type: attribute
          #             - attribute: last_backup
          #               entity: sensor.samba_backup
          #               icon: 'mdi:file-clock-outline'
          #               name: Last Backup
          #               type: attribute
          #   double_tap_action:
          #     action: navigate
          #     navigation_path: /hassio/backups                     
  - type: entities
    show_header_toggle: false
    entities:
      - entity:  update.home_assistant_core_update
        type: custom:multiple-entity-row
        name: Core
        show_state: false
        icon: mdi:update
        entities:
          - attribute: installed_version
            name: Installiert
          - attribute: latest_version
            name: Verf端gbar
        tap_action: 
          action: navigate
          navigation_path:  /config/dashboard
      - entity:  update.home_assistant_supervisor_update
        type: custom:multiple-entity-row
        name: Supervisor
        icon: mdi:update
        show_state: false
        entities:
          - attribute: installed_version
            name: Installiert
          - attribute: latest_version
            name: Verf端gbar
        tap_action: 
          action: navigate
          navigation_path:  /config/dashboard
      - entity:  sensor.updater_supervisor
        type: custom:multiple-entity-row
        name: Add-ons
        icon: mdi:update
        tap_action: 
          action: navigate
          navigation_path: /hassio
      - entity: sensor.hacs
        name: Hacs
        tap_action: 
          action: navigate
          navigation_path: /hacs
      - entity: binary_sensor.docker_update
        tap_action:
          action: fire-dom-event
          browser_mod:
            service: browser_mod.popup
            data:
              title: Docker Container
              style: |
                --popup-border-width: 0px;
                --ha-card-border-color: var(--popup-border-color);
              card_mod:
                !include ../includes/popups/popup_styles.yaml
              content:
                  type: custom:auto-entities
                  card:
                    type: entities
                  filter:
                    include:
                      - entity_id: "update.wud_container*"
        double_tap_action:
          action: url
          url_path: https://wud.tanzer-cloud.de/
      # - entity: sensor.nextcloud_release 
      #   type: custom:multiple-entity-row
      #   state_header: Verf端gbar
      #   entities:
      #     - entity: sensor.nextcloud_system_version 
      #       name: Installiert
      #   double_tap_action:
      #     action: url
      #     url_path: https://next.tanzer-online.com
      - entity:  update.nextcloud_hub
        type: custom:multiple-entity-row
        name: Nextcloud Hub
        icon: mdi:update
        show_state: false
        entities:
          - attribute: installed_version
            name: Installiert
          - attribute: latest_version
            name: Verf端gbar
      - type: custom:fold-entity-row
        padding: 5
        head:
          type: section
          label: Details
        entities:
          - entity: sensor.anzahl_automationen
            tap_action:
              action: navigate
              navigation_path: /config/automation/dashboard
          - entity: sensor.anzahl_skripte
            tap_action:
              action: navigate
              navigation_path: /config/script/dashboard
          - entity: sensor.online_time
            name: Hass online
            icon: mdi:home-assistant
          - entity: sensor.last_boot
            name: Raspi online
            icon: mdi:raspberry-pi
  - type: entities
    entities:
      - entity: automation.batterie_niedriger_batteriestand
        icon: mdi:battery-alert
        name: Benachrichtung Batteriestand
        tap_action:
          action: fire-dom-event
          browser_mod:
            service: browser_mod.popup
            data:
              title: Status
              style: |
                --popup-border-width: 0px;
                --ha-card-border-color: var(--popup-border-color);
              card_mod:
                !include ../includes/popups/popup_styles.yaml
              content:
                type: custom:auto-entities
                card:
                  type: entities
                filter:
                  include:
                    - entity_id: "sensor.*_battery*"
                      options:
                        type: custom:battery-entity-row
                  exclude:
                    - entity_id: "*iphone*"
                    - entity_id: "*ipad*"
                sort:
                  method: 
                    - name
        double_tap_action:
          action: navigate
          navigation_path: /config/automation/edit/1630350328215
  - type: entities
    entities:
      - entity: switch.ds118
        icon: mdi:nas
        tap_action:
          action: toggle
          confirmation:
            text: NAS ein-/ausschalten?
      - type: custom:auto-entities
        filter:
          include:
            - entity_id: "sensor.ynzvpg2*"
              # options:
              #   tap_action:
              #     action: none
        sort:
          method: name
        card:
          type: custom:fold-entity-row
          head:
            type: section
            label: Syncthing Status
          padding: 5

  - type: grid
    columns: 2
    square: false
    cards:
      - type: 'custom:button-card'
        name: Mitteilung entf.
        entity: script.notify_clean_messages
        template:
          - script
        variables:
          entity: script.notify_clean_messages
      - type: 'custom:button-card'
        entity: script.notify_clean_badge
        name: Badge entf.
        template:
          - script
        variables:
          entity: script.notify_clean_badge       
  - template: blank
    type: 'custom:button-card'  